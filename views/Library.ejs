<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="/css/library.css">
</head>

<body>

    <%- include('Dashboard') %>

        <div class="library">

            <div class="home-library">
                <p>Home><b>Library</b></p>
            </div>

            <div class="media-widgets">
                <div class="media">
                    <p>Media</p>
                </div>
                <div class="widgets">
                    <p>Widgets</p>
                </div>
            </div>

            <div class="media-info">
                <div class="left">
                    <div class="media-allFiles">
                        <h6>ALL MEDIA FILES</h6>
                        <p>TOTAL FILES - </p>
                    </div>
                </div>
                <div class="right">
                    <div class="media-category">
                        <button class="media-all">All</button>
                        <button class="media-photos">Photos</button>
                        <button class="media-videos">Videos</button>
                    </div>
                    <div class="media-search">
                        <input type="search" name="search" id="search" placeholder="Search">
                    </div>
                    <div class="media-btn">
                        <button class="media-btn-folder"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 5V19" stroke="white" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                                <path d="M5 12H19" stroke="white" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                            New Folder</button>
                        <button class="media-btn-upload" id="uploadButton">Upload Media</button>
                        <form id="uploadForm" action="/Dashboard/Library/UploadMedia" method="POST"
                            enctype="multipart/form-data" style="display: none;">
                            <input type="file" name="file" id="fileInput">
                            <button type="submit" id="submitBtn">Upload</button>
                        </form>
                    </div>
                </div>
            </div>
            <% if (mediafiles && mediafiles.length===0) { %>
                <!-- No files uploaded message -->
                <div class="mediaShow-nofile">
                    <div class="nofile">
                        <svg width="54" height="54" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_4002_445)">
                                <path d="M16 16L12 12L8 16" stroke="#464849" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                                <path d="M12 12V21" stroke="#464849" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                                <path
                                    d="M20.3914 18.39C21.3668 17.8583 22.1373 17.0169 22.5813 15.9986C23.0253 14.9804 23.1176 13.8432 22.8436 12.7667C22.5696 11.6901 21.9449 10.7355 21.0681 10.0534C20.1913 9.37137 19.1123 9.00072 18.0014 8.99998H16.7414C16.4387 7.82923 15.8746 6.74232 15.0914 5.82098C14.3082 4.89964 13.3263 4.16783 12.2195 3.68059C11.1128 3.19335 9.90998 2.96334 8.70154 3.00787C7.49311 3.05239 6.31049 3.37028 5.2426 3.93765C4.17471 4.50501 3.24934 5.30709 2.53605 6.28357C1.82276 7.26004 1.34012 8.38552 1.1244 9.57538C0.908695 10.7652 0.96553 11.9885 1.29064 13.1532C1.61575 14.318 2.20067 15.3938 3.00143 16.3"
                                    stroke="#464849" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                <path d="M16 16L12 12L8 16" stroke="#464849" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </g>
                            <defs>
                                <clipPath id="clip0_4002_445">
                                    <rect width="24" height="24" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                        <span>Browse Files(.jpg, .jpeg, .png, .mp4)</span>
                    </div>
                </div>
                <% } else { %>
                    <!-- Show media files -->
                    <div class="show-media">
                        <% mediafiles.forEach(function(file) { %>
                            <div class="media-container">
                                <!-- Debugging: Print file object -->
                                <%# console.log('File:', file); %>
                                    <% if (file.type && file.type.startsWith('image/')) { %>
                                        <img src="<%= file.url %>" alt="Image" class="media-item image-item">
                                        <% } else if (file.type && file.type.startsWith('video/')) { %>
                                            <video controls class="media-item video-item" preload="metadata">
                                                <source src="<%= file.url %>" type="<%= file.type %>">
                                                Your browser does not support the video tag.
                                            </video>
                                            <% } else { %>
                                                <p>Unsupported file type: <%= file.type %>
                                                </p>
                                                <% } %>
                            </div>
                            <% }); %>
                    </div>
                    <% } %>

        </div>
        <script src="/javaScripts/uploadFile.js"></script>
</body>

</html>